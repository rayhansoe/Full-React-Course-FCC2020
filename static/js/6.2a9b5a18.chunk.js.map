{"version":3,"sources":["tutorial/4-useReducer/reducer.js","tutorial/4-useReducer/UseReducerTopic.jsx","tools.js"],"names":["reducer","state","action","type","users","payload","isError","isFetchLoading","isPageLoading","url","newUsers","filter","user","id","Error","List","lazy","MyInput","StateContext","createContext","defaultState","UseReducerTopic","useReducer","dispatch","inputRef","useRef","handleSubmit","e","preventDefault","current","value","useEffect","getUsersData","a","checkStatus","catch","err","console","log","result","setTimeout","reFetchData","length","Provider","style","marginBottom","to","className","onSubmit","fallback","nameForId","status","label","ref","disabled","onClick","fetch","response","data","json","statusText"],"mappings":"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","file":"static/js/6.2a9b5a18.chunk.js","sourcesContent":["// reducer function.\r\nexport const reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase \"FIRST_RENDER\":\r\n\t\t\t// const newUsers = [...state.users, ...action.payload.users]\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...state.users, ...action.payload.users],\r\n\t\t\t}\r\n\r\n\t\tcase \"ERROR_FETCHING\":\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisError: action.payload.isError,\r\n\t\t\t}\r\n\r\n\t\tcase \"FETCH_STATUS\":\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisFetchLoading: action.payload.isFetchLoading,\r\n\t\t\t}\r\n\r\n\t\tcase \"LOADING_FINISHED\":\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisPageLoading: action.payload.isPageLoading,\r\n\t\t\t}\r\n\r\n\t\tcase \"ADD_URL\":\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\turl: action.payload.url,\r\n\t\t\t}\r\n\r\n\t\tcase \"REMOVE_USER\":\r\n\t\t\tconst newUsers = state.users.filter(user => user.id !== action.payload.id)\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: newUsers,\r\n\t\t\t}\r\n\r\n\t\tcase \"RE-FETCH\":\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tusers: [...action.payload.users],\r\n\t\t\t}\r\n\r\n\t\tdefault:\r\n\t\t\tthrow new Error(\"no matching action type\")\r\n\t}\r\n}\r\n","import React, { useEffect, useReducer, useRef, createContext, lazy, Suspense } from \"react\"\r\nimport { Link } from \"react-router-dom\"\r\n\r\nimport { reducer } from \"./reducer\"\r\nimport { checkStatus } from \"../../tools\"\r\n\r\nconst List = lazy(() => import(\"./components/List\"))\r\nconst MyInput = lazy(() => import(\"./components/MyInput\"))\r\n\r\n// createContext\r\nexport const StateContext = createContext()\r\n\r\n// default state\r\nconst defaultState = {\r\n\tisFetchLoading: false,\r\n\tisError: false,\r\n\tusers: [],\r\n\turl: \"\",\r\n\tisPageLoading: true,\r\n}\r\n\r\n// main component\r\nconst UseReducerTopic = () => {\r\n\tconst [state, dispatch] = useReducer(reducer, defaultState)\r\n\tconst inputRef = useRef(null)\r\n\r\n\tconst handleSubmit = e => {\r\n\t\te.preventDefault()\r\n\t\tif (inputRef.current.value) {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: \"ADD_URL\",\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\turl: inputRef.current.value,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: \"FETCH_STATUS\",\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\tisFetchLoading: true,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tconst handleClick = id => {\r\n\t\tdispatch({\r\n\t\t\ttype: \"REMOVE_USER\",\r\n\t\t\tpayload: {\r\n\t\t\t\tid,\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\r\n\t// // user list\r\n\t// const List = () => {\r\n\t// \treturn state.users.map(user => {\r\n\t// \t\treturn <MyItem key={user.id} user={user} handleClick={handleClick} />\r\n\t// \t})\r\n\t// }\r\n\r\n\t// the side effect for data fetching\r\n\tuseEffect(() => {\r\n\t\tconst getUsersData = async () => {\r\n\t\t\tconst result = await checkStatus(state.url).catch(err => console.log(err))\r\n\t\t\tresult &&\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"FIRST_RENDER\",\r\n\t\t\t\t\tpayload: { users: result },\r\n\t\t\t\t})\r\n\r\n\t\t\t!result &&\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"ERROR_FETCHING\",\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"FETCH_STATUS\",\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tisFetchLoading: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t}, 500)\r\n\t\t}\r\n\r\n\t\tconst reFetchData = async () => {\r\n\t\t\tconst result = await checkStatus(state.url).catch(err => console.log(err))\r\n\t\t\tresult &&\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"RE-FETCH\",\r\n\t\t\t\t\tpayload: { users: result },\r\n\t\t\t\t})\r\n\r\n\t\t\t!result &&\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"ERROR_FETCHING\",\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: \"FETCH_STATUS\",\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tisFetchLoading: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t})\r\n\t\t\t}, 500)\r\n\t\t}\r\n\r\n\t\tif (!state.users.length && state.url) {\r\n\t\t\tgetUsersData()\r\n\t\t} else if (state.users.length < 30 && state.users.length !== 0 && state.isFetchLoading) {\r\n\t\t\treFetchData()\r\n\t\t}\r\n\t}, [state.isFetchLoading, state.isPageLoading, state.url, state.users.length])\r\n\r\n\t// when the page still loading\r\n\tif (state.isPageLoading) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tdispatch({ type: \"LOADING_FINISHED\", payload: { isPageLoading: false } })\r\n\t\t}, 500)\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<h1>Loading....</h1>\r\n\t\t\t</>\r\n\t\t)\r\n\t}\r\n\r\n\t// when the page is error\r\n\tif (state.isError) {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<h2>Something went wrong...</h2>\r\n\t\t\t\t<h3>check your console....</h3>\r\n\t\t\t</>\r\n\t\t)\r\n\t}\r\n\r\n\t// when the loading is finished\r\n\treturn (\r\n\t\t<StateContext.Provider value={[state, dispatch, handleClick, handleSubmit]}>\r\n\t\t\t<h3 style={{ marginBottom: \"40px\" }}>UseEffect | UseReducer | UseRef | Fetch</h3>\r\n\r\n\t\t\t<Link to='/'>\r\n\t\t\t\t<p>{\"< \"}back</p>{\" \"}\r\n\t\t\t</Link>\r\n\r\n\t\t\t<h5>url : https://api.github.com/users</h5>\r\n\t\t\t<section>\r\n\t\t\t\t<form className='form' onSubmit={handleSubmit}>\r\n\t\t\t\t\t<Suspense fallback={<h1>Loading...</h1>}>\r\n\t\t\t\t\t\t<MyInput\r\n\t\t\t\t\t\t\tnameForId='url'\r\n\t\t\t\t\t\t\tstatus={state.url ? true : false}\r\n\t\t\t\t\t\t\tlabel='Url : '\r\n\t\t\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\t\t\ttype='url'\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Suspense>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype='submit'\r\n\t\t\t\t\t\tdisabled={state.users.length === 30 && state.users.length !== 0 ? true : false}\r\n\t\t\t\t\t\tonClick={handleSubmit}>\r\n\t\t\t\t\t\t{state.users.length <= 30 && state.users.length !== 0 ? \"re-fetch\" : \"add url\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</form>\r\n\t\t\t</section>\r\n\t\t\t<section>\r\n\t\t\t\t{state.isFetchLoading ? (\r\n\t\t\t\t\t<h3>Loading...</h3>\r\n\t\t\t\t) : (\r\n\t\t\t\t\tstate.url && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<h3>GitHub Users</h3>\r\n\t\t\t\t\t\t\t<ul className='users'>\r\n\t\t\t\t\t\t\t\t<Suspense fallback={<h1>Loading...</h1>}>\r\n\t\t\t\t\t\t\t\t\t<List />\r\n\t\t\t\t\t\t\t\t</Suspense>\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)\r\n\t\t\t\t)}\r\n\t\t\t</section>\r\n\t\t</StateContext.Provider>\r\n\t)\r\n}\r\n\r\nexport default UseReducerTopic\r\n","export const checkStatus = async url => {\r\n\tconst response = await fetch(url)\r\n\tif (200 && response.status <= 299) {\r\n\t\tconst data = response.json()\r\n\t\treturn data\r\n\t}\r\n\tthrow new Error(response.statusText)\r\n}\r\n"],"sourceRoot":""}